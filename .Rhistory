right = -116.8, top = 33.25))
ggmap(map_stamen, extent = "device") +
geom_point(aes(x = x1, y = x2, col = var1.pred), fit.k_ll) +
geom_point(aes(x = lng, y = lat), data = as.data.frame(sites_sub)) +
scale_color_distiller(palette = "YlOrRd", direction = 1)
fit.k_ll <- spTransform(fit.k, CRS("+proj=longlat")) %>% as.data.frame()
map_stamen <- get_stamenmap(bbox = c(left = -117.3, bottom = 32.45,
right = -116.8, top = 33.20))
ggmap(map_stamen, extent = "device") +
geom_point(aes(x = x1, y = x2, col = var1.pred), fit.k_ll) +
geom_point(aes(x = lng, y = lat), data = as.data.frame(sites_sub)) +
scale_color_distiller(palette = "YlOrRd", direction = 1)
fit.k_ll <- spTransform(fit.k, CRS("+proj=longlat")) %>% as.data.frame()
map_stamen <- get_stamenmap(bbox = c(left = -117.3, bottom = 32.50,
right = -116.8, top = 33.20))
ggmap(map_stamen, extent = "device") +
geom_point(aes(x = x1, y = x2, col = var1.pred), fit.k_ll) +
geom_point(aes(x = lng, y = lat), data = as.data.frame(sites_sub)) +
scale_color_distiller(palette = "YlOrRd", direction = 1)
fit.k_ll <- spTransform(fit.k, CRS("+proj=longlat")) %>% as.data.frame()
map_stamen <- get_stamenmap(bbox = c(left = -117.3, bottom = 32.50,
right = -116.85, top = 33.20))
ggmap(map_stamen, extent = "device") +
geom_point(aes(x = x1, y = x2, col = var1.pred), fit.k_ll) +
geom_point(aes(x = lng, y = lat), data = as.data.frame(sites_sub)) +
scale_color_distiller(palette = "YlOrRd", direction = 1)
fit.k_ll <- spTransform(fit.k, CRS("+proj=longlat")) %>% as.data.frame()
map_stamen <- get_stamenmap(bbox = c(left = -117.3, bottom = 32.50,
right = -116.85, top = 33.20))
ggmap(map_stamen, extent = "device") +
geom_point(aes(x = x1, y = x2, col = var1.pred), fit.k_ll) +
geom_point(aes(x = lng, y = lat), data = as.data.frame(sites_sub)) +
scale_color_distiller(palette = "YlOrRd", direction = 1)
ggmap(map_stamen, extent = "device") +
geom_point(aes(x = x1, y = x2, col = var1.pred), fit.k_ll)
ggmap(map_stamen, extent = "device") +
geom_point(aes(x = x1, y = x2, col = var1.pred), fit.k_ll) +
geom_point(aes(x = lng, y = lat), data = as.data.frame(sites_sub))
ggmap(map_stamen, extent = "device") +
geom_point(aes(x = x1, y = x2, col = var1.pred), fit.k_ll) +
geom_point(aes(x = lng, y = lat), data = as.data.frame(sites_sub)) +
scale_color_distiller(palette = "YlOrRd", direction = 1)
ggmap(map_stamen, extent = "device") +
geom_point(aes(x = x1, y = x2, col = var1.pred), fit.k_ll) +
geom_point(aes(x = lng, y = lat), data = as.data.frame(sites_sub)) +
scale_color_distiller(palette = "YlOrRd")
ggmap(map_stamen, extent = "device") +
geom_point(aes(x = x1, y = x2, col = var1.pred), fit.k_ll) +
geom_point(aes(x = lng, y = lat), data = as.data.frame(sites_sub)) +
scale_color_distiller(palette = "YlOrRd", direction = 1)
ggmap(map_stamen, extent = "device") +
geom_point(aes(x = lng, y = lat), data = as.data.frame(sites_sub)) +
geom_point(aes(x = x1, y = x2, col = var1.pred), fit.k_ll) +
scale_color_distiller(palette = "YlOrRd", direction = 1)
fit.k_ll <- spTransform(fit.k, CRS("+proj=longlat")) %>% as.data.frame()
map_stamen <- get_stamenmap(bbox = c(left = -117.3, bottom = 32.50,
right = -116.85, top = 33.20))
ggmap(map_stamen, extent = "device") +
geom_point(aes(x = x1, y = x2, col = var1.pred), fit.k_ll) +
geom_point(aes(x = lng, y = lat), data = as.data.frame(sites_sub)) +
scale_color_distiller(palette = "YlOrRd", direction = 1)
ggmap(map_stamen, extent = "device") +
geom_point(aes(x = x1, y = x2, col = var1.pred), fit.k_ll) +
geom_point(aes(x = lng, y = lat), data = as.data.frame(sites_sub)) +
scale_color_distiller(palette = "YlOrRd", direction = 1) +
labs(x = "hh",
y = "dd")
ggmap(map_stamen, extent = "device") +
geom_point(aes(x = x1, y = x2, col = var1.pred), fit.k_ll) +
# geom_point(aes(x = lng, y = lat), data = as.data.frame(sites_sub)) +
scale_color_distiller(palette = "YlOrRd", direction = 1)
ggmap(map_stamen, extent = "device") +
# geom_point(aes(x = x1, y = x2, col = var1.pred), fit.k_ll) +
geom_point(aes(x = lng, y = lat), data = as.data.frame(sites_sub)) +
scale_color_distiller(palette = "YlOrRd", direction = 1)
as.data.frame(sites_sub)
sites_sub %<>% spTransform(., CRS("+proj=longlat"))
sites_sub %<>% spTransform(., CRS("+proj=longlat")) %>% as.data.frame()
head(sites_sub)
fit.k_ll %<>%
spTransform(CRS("+proj=longlat")) %>% as.data.frame()
fit.k_ll %<>%
spTransform(., CRS("+proj=longlat")) %>% as.data.frame()
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)
library(sp)
library(ggmap)
library(tidyverse)
library(magrittr)
library(gstat)
library(knitr)
library(kableExtra)
setwd(here::here())
load("data/city_boundary.RData") #loads sd_city variable
water_testing <- read.csv("data/indicator_bacteria_tests_datasd_v1.csv")
sites_ll <- read.csv("data/sample_sites_datasd_v1.csv")
load("data/sd_tracts_income.RData")
load("data/sd_grid.RData")
# prepare data
coordinates(sites_ll) <- c("lng", "lat")
proj4string(sites_ll) <- CRS("+proj=longlat")
sites <- spTransform(sites_ll, proj4string(sd_city))
proj4string(sd_city)
sites <- spTransform(sites, CRS("+proj=longlat"))
map_stamen <- get_stamenmap(bbox = c(left = -117.3, bottom = 32.55,
right = -116.9, top = 33.05))
ggmap(map_stamen) +
geom_point(aes(x = lng, y = lat), data = as.data.frame(sites))
sites$cl2_total <- sapply(as.character(sites_ll$site_ID), function(site){
median(water_testing$cl2_total[water_testing$source == site], na.rm = T)
})
sites_sub <- sites[!is.na(sites$cl2_total),]
sd_tracts@proj4string
sites_sub %<>% spTransform(., proj4string(sd_tracts))
sites_sub_new <- over(sites_sub, sd_tracts)
sites_sub@data %<>%
cbind(median_income = sites_sub_new$median_income)
sites_sub$median_income %>% head
fit.lm <- lm(cl2_total ~ median_income, sites_sub)
tidy.lm <- broom::tidy(fit.lm)
confint.lm <- confint(fit.lm)
cbind(tidy.lm, confint.lm) %>%
kable(row.names = FALSE) %>%
kable_styling(full_width = FALSE)
my_vario <- variogram(cl2_total ~ median_income, sites_sub)
fit.v <- fit.variogram(object = my_vario,
model = vgm(model = "Mat", psill = 0.10, range = 3000, nugget = 0.25))
fit.v %>%
select(model, psill, range, kappa) %>%
kable() %>%
kable_styling(full_width = FALSE)
fit.k <- krige(formula = cl2_total ~ median_income, locations = sites_sub,
newdata = sd_grid, model = fit.v)
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)
library(sp)
library(ggmap)
library(tidyverse)
library(magrittr)
library(gstat)
library(knitr)
library(kableExtra)
setwd(here::here())
load("data/city_boundary.RData") #loads sd_city variable
water_testing <- read.csv("data/indicator_bacteria_tests_datasd_v1.csv")
sites_ll <- read.csv("data/sample_sites_datasd_v1.csv")
load("data/sd_tracts_income.RData")
load("data/sd_grid.RData")
# prepare data
coordinates(sites_ll) <- c("lng", "lat")
proj4string(sites_ll) <- CRS("+proj=longlat")
sites <- spTransform(sites_ll, proj4string(sd_city))
proj4string(sd_city)
sites <- spTransform(sites, CRS("+proj=longlat"))
map_stamen <- get_stamenmap(bbox = c(left = -117.3, bottom = 32.55,
right = -116.9, top = 33.05))
ggmap(map_stamen) +
geom_point(aes(x = lng, y = lat), data = as.data.frame(sites))
sites$cl2_total <- sapply(as.character(sites_ll$site_ID), function(site){
median(water_testing$cl2_total[water_testing$source == site], na.rm = T)
})
sites_sub <- sites[!is.na(sites$cl2_total),]
sd_tracts@proj4string
sites_sub %<>% spTransform(., proj4string(sd_tracts))
sites_sub_new <- over(sites_sub, sd_tracts)
sites_sub@data %<>%
cbind(median_income = sites_sub_new$median_income)
sites_sub$median_income %>% head
fit.lm <- lm(cl2_total ~ median_income, sites_sub)
tidy.lm <- broom::tidy(fit.lm)
confint.lm <- confint(fit.lm)
cbind(tidy.lm, confint.lm) %>%
kable(row.names = FALSE) %>%
kable_styling(full_width = FALSE)
my_vario <- variogram(cl2_total ~ median_income, sites_sub)
fit.v <- fit.variogram(object = my_vario,
model = vgm(model = "Mat", psill = 0.10, range = 3000, nugget = 0.25))
fit.v %>%
select(model, psill, range, kappa) %>%
kable() %>%
kable_styling(full_width = FALSE)
fit.k <- krige(formula = cl2_total ~ median_income, locations = sites_sub,
newdata = sd_grid, model = fit.v)
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)
fit.k_ll %<>%
spTransform(., CRS("+proj=longlat")) %>% as.data.frame()
fit.k_ll <- fit.k %>%
spTransform(., CRS("+proj=longlat")) %>% as.data.frame()
sites_sub %<>% spTransform(., CRS("+proj=longlat")) %>% as.data.frame()
map_stamen <- get_stamenmap(bbox = c(left = -117.3, bottom = 32.50,
right = -116.85, top = 33.20))
ggmap(map_stamen, extent = "device") +
geom_point(aes(x = x1, y = x2, col = var1.pred), fit.k_ll) +
geom_point(aes(x = lng, y = lat), data = as.data.frame(sites_sub)) +
scale_color_distiller(palette = "YlOrRd", direction = 1)
fit.k_ll <- fit.k %>%
spTransform(., CRS("+proj=longlat")) %>% as.data.frame()
sites_sub %<>% spTransform(., CRS("+proj=longlat")) %>% as.data.frame()
ggmap(map_stamen, extent = "device") +
geom_point(aes(x = x1, y = x2, col = var1.pred), fit.k_ll) +
geom_point(aes(x = lng, y = lat), data = as.data.frame(sites_sub)) +
scale_color_distiller(palette = "YlOrRd", direction = 1)
fit.k_ll
fit.k_ll <- fit.k %>%
spTransform(., CRS("+proj=longlat")) %>% as.data.frame()
sites_sub %<>% spTransform(., CRS("+proj=longlat")) %>% as.data.frame()
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)
library(sp)
library(ggmap)
library(tidyverse)
library(magrittr)
library(gstat)
library(knitr)
library(kableExtra)
setwd(here::here())
load("data/city_boundary.RData") #loads sd_city variable
water_testing <- read.csv("data/indicator_bacteria_tests_datasd_v1.csv")
sites_ll <- read.csv("data/sample_sites_datasd_v1.csv")
load("data/sd_tracts_income.RData")
load("data/sd_grid.RData")
# prepare data
coordinates(sites_ll) <- c("lng", "lat")
proj4string(sites_ll) <- CRS("+proj=longlat")
sites <- spTransform(sites_ll, proj4string(sd_city))
proj4string(sd_city)
sites <- spTransform(sites, CRS("+proj=longlat"))
map_stamen <- get_stamenmap(bbox = c(left = -117.3, bottom = 32.55,
right = -116.9, top = 33.05))
ggmap(map_stamen) +
geom_point(aes(x = lng, y = lat), data = as.data.frame(sites))
sites$cl2_total <- sapply(as.character(sites_ll$site_ID), function(site){
median(water_testing$cl2_total[water_testing$source == site], na.rm = T)
})
sites_sub <- sites[!is.na(sites$cl2_total),]
sd_tracts@proj4string
sites_sub %<>% spTransform(., proj4string(sd_tracts))
sites_sub_new <- over(sites_sub, sd_tracts)
sites_sub@data %<>%
cbind(median_income = sites_sub_new$median_income)
sites_sub$median_income %>% head
fit.lm <- lm(cl2_total ~ median_income, sites_sub)
tidy.lm <- broom::tidy(fit.lm)
confint.lm <- confint(fit.lm)
cbind(tidy.lm, confint.lm) %>%
kable(row.names = FALSE) %>%
kable_styling(full_width = FALSE)
my_vario <- variogram(cl2_total ~ median_income, sites_sub)
fit.v <- fit.variogram(object = my_vario,
model = vgm(model = "Mat", psill = 0.10, range = 3000, nugget = 0.25))
fit.v %>%
select(model, psill, range, kappa) %>%
kable() %>%
kable_styling(full_width = FALSE)
fit.k <- krige(formula = cl2_total ~ median_income, locations = sites_sub,
newdata = sd_grid, model = fit.v)
fit.k_ll <- fit.k %>%
spTransform(., CRS("+proj=longlat")) %>% as.data.frame()
sites_sub %<>% spTransform(., CRS("+proj=longlat")) %>% as.data.frame()
map_stamen <- get_stamenmap(bbox = c(left = -117.3, bottom = 32.50,
right = -116.85, top = 33.20))
ggmap(map_stamen, extent = "device") +
geom_point(aes(x = x1, y = x2, col = var1.pred), fit.k_ll) +
geom_point(aes(x = lng, y = lat), data = as.data.frame(sites_sub)) +
scale_color_distiller(palette = "YlOrRd", direction = 1)
ggmap(map_stamen) +
geom_point(aes(x = x1, y = x2, col = var1.pred), fit.k_ll) +
geom_point(aes(x = lng, y = lat), data = as.data.frame(sites_sub)) +
scale_color_distiller(palette = "YlOrRd", direction = 1)
install.packages("tlmgr.pl")
rmarkdown::render("R/kristine-dinh-continuous-spatial-index.Rmd", output_format = "pdf_document")
setwd("R")
rmarkdown::render("kristine-dinh-continuous-spatial-index.Rmd", output_format = "pdf_document")
sd_city@proj4string
```{r fig.height=3}
sites <- spTransform(sites, CRS("+proj=longlat"))
map_stamen <- get_stamenmap(bbox = c(left = -117.3, bottom = 32.55,
right = -116.9, top = 33.05))
ggmap(map_stamen) +
geom_point(aes(x = lng, y = lat), data = as.data.frame(sites))
sites <- spTransform(sites, CRS("+proj=longlat"))
map_stamen <- get_stamenmap(bbox = c(left = -117.3, bottom = 32.55,
right = -116.9, top = 33.05))
ggmap(map_stamen) +
geom_point(aes(x = lng, y = lat), data = as.data.frame(sites))
library(leaflet)
install.packages("leaflet")
library(leaflet)
library(leaflet)
version
getwd()
quivR::quivr_colors()
quivR::quivr_colors(2)
library(tidyverse)
quivR::quivr_colors(2)
y1 <- c(1,2,3,3,4)
rank(y1)
y1 <- c(1,6,2,3,3,4)
rank(y1)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
library(tidyverse)
library(sp)
setwd(here::here())
earthquakes <- read.csv("Kansas_Earthquake_Database.csv")
setwd(here::here())
earthquakes <- read.csv("data/Kansas_Earthquake_Database.csv")
coordinates(earthquakes) <- c("Longitude", "Latitude")
proj4string(earthquakes) <- CRS("+proj=longlat")
head(earthquakes)
head(earthquakes)
kansas <- tigris::tracts("KS")
library(tigris)
kansas <- tracts("KS", cb = TRUE)
kansas <- tracts("KS", cb = TRUE, year = 2016)
library(magrittr)
'earthquakes@data$Time'
'earthquakes@data$Time'
earthquakes@data$Time
earthquakes@data$ï..Date
earthquakes@data %<>% rename(Date = ï..Date)
earthquakes@data$Date
strptime(earthquakes@data$Date, "%m/%d/%y")
earthquakes@data %<>%
mtuate(POSIX = strptime(Date, "%m/%d/%y"))
earthquakes@data %<>%
mutate(POSIX = strptime(Date, "%m/%d/%y"))
earthquakes@data %<>%
mutate("POSIX" = strptime(Date, "%m/%d/%y"))
earthquakes@data
strptime(earthquakes@data$Date, "%m/%d/%y")
strptime(earthquakes@data$Date, "%m/%d/%y") %>% class
earthquakes@data %<>%
mutate("POSIX" = strptime(.$Date, "%m/%d/%y"))
earthquakes@data$POSIX <- strptime(earthquakes@data$Date, "%m/%d/%y"))
earthquakes@data$POSIX <- strptime(earthquakes@data$Date, "%m/%d/%y")
earthquakes@data
max(earthquakes@data$Date)
max(earthquakes@data$POSIX)
which(max(earthquakes@data$POSIX))
which(earthquake@data)
which(earthquakes@data == max(earthquakes@data$POSIX))
which.max(earthquakes@data$POSIX)
which.max(earthquakes$POSIX)
earthquakes@data %>% head
earthquakes@data[earthquakes@data$POSIX == max(earthquakes@data$POSIX)]
earthquakes@data[earthquakes@data$POSIX == max(earthquakes@data$POSIX)] %>% head
max(earthquakes@data$POSIX)
earthquakes@data %>% filter(POSIX == max(earthquakes@data$POSIX))
earthquakes@data[earthquakes@data$POSIX == max(earthquakes@data$POSIX)]
earthquakes$POSIX
a <- earthquakes@data
View(a)
max(earthquakes@data$POSIX)
as.Date(earthquakes@data$POSIX)
max(as.Date(earthquakes@data$POSIX))
earthquakes@data == max(earthquakes@data$POSIX)
earthquakes@data = max(earthquakes@data$POSIX)
which(earthquakes@data == max(earthquakes@data$POSIX))
which(earthquakes@data$POSIX == max(earthquakes@data$POSIX))
earthquakes@data[which(earthquakes@data$POSIX == max(earthquakes@data$POSIX))]
earthquakes@data[which(earthquakes@data$POSIX == max(earthquakes@data$POSIX)), ]
a %>% filter(POSIX == max(POSIX))
a %>% filter(POSIX == max(as.character(POSIX)))
a %>% arrange(desc(POSIX))
a %>% arrange(desc(as.Date(POSIX)))
earthquakes@data[which(earthquakes@data$POSIX == max(earthquakes@data$POSIX)), ]
earthquakes@data[which(earthquakes@data$POSIX == max(earthquakes@data$POSIX)), ]
earthquakes@data[which(earthquakes@data$POSIX == max(earthquakes@data$POSIX)), ]
earthquakes@data[which(earthquakes@data$POSIX == max(earthquakes@data$POSIX)), ]
earthquakes@data$POSIX %>%
group_by(lubridate::year(POSIX)) %>%
tally()
earthquakes@data %<>%
mutate(year = lubridate::year(POSIX))
earthquakes@data$year <- lubridate::year(earthquakes@data$POSIX))
earthquakes@data$year <- lubridate::year(earthquakes@data$POSIX)
earthquakes@data$POSIX %>%
group_by(year) %>%
tally()
earthquakes@data %>%
group_by(year) %>%
tally()
tally()
group_by(year) %>% earthquakes@data %>%
group_by(year) %>%
tally()
earthquakes@data %>%
group_by(year) %>%
tally()
earthquakes@data %>%
group_by(year) %>%
tally() %>%
select(year %in% c(2002, 2012, 2015))
earthquakes@data %>%
group_by(year) %>%
tally() %>%
select(year %in% c(2002, 2012, 2015))
earthquakes@data %>%
group_by(year) %>%
tally()
a <- earthquakes@data %>%
group_by(year) %>%
tally()
a$year
earthquakes@data %>%
group_by(year) %>%
tally() %>%
filter(year %in% c(2002, 2012, 2015))
earthquakes@data %>%
group_by(year) %>%
tally() %>%
filter(year %in% c(2002, 2012, 2015))
setwd(here::here())
earthquakes <- read.csv("data/Kansas_Earthquake_Database.csv")
coordinates(earthquakes) <- c("Longitude", "Latitude")
proj4string(earthquakes) <- CRS("+proj=longlat")
# actively producing gas and oil wells in Kansas data
load("data/wells.RData")
# edit data
earthquakes@data %<>% rename(Date = ï..Date)
setwd(here::here())
earthquakes <- read.csv("data/Kansas_Earthquake_Database.csv")
coordinates(earthquakes) <- c("Longitude", "Latitude")
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
library(tidyverse)
library(sp)
library(tigris)
library(magrittr)
setwd(here::here())
earthquakes <- read.csv("data/Kansas_Earthquake_Database.csv")
coordinates(earthquakes) <- c("Longitude", "Latitude")
proj4string(earthquakes) <- CRS("+proj=longlat")
# actively producing gas and oil wells in Kansas data
load("data/wells.RData")
# edit data
earthquakes@data %<>% rename(Date = "ï..Date")
kansas <- tracts("KS", cb = TRUE, year = 2016)
earthquakes@data$POSIX <- strptime(earthquakes@data$Date, "%m/%d/%y")
earthquakes@data[which(earthquakes@data$POSIX == max(earthquakes@data$POSIX)), ]
earthquakes@data$year <- lubridate::year(earthquakes@data$POSIX)
earthquakes@data %>%
group_by(year) %>%
tally() %>%
filter(year %in% c(2002, 2012, 2015))
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
earthquakes@data$POSIX <- strptime(earthquakes@data$Date, "%m/%d/%y")
earthquakes@data[which(earthquakes@data$POSIX == max(earthquakes@data$POSIX)), ]
earthquakes@data$year <- lubridate::year(earthquakes@data$POSIX)
earthquakes@data %>%
group_by(year) %>%
tally() %>%
filter(year %in% c(2002, 2012, 2015))
wells@data$COMPLETION_POSIX
wells@data$COMPLETION_POSIX %>% class
wells@data$COMPLETION_POSIX %<>% as.POSIXct()
wells@data$COMPLETION_POSIX %>% class
wells@data$COMPLETION_POSIX %>% max
wells@data$COMPLETION_POSIX %>% max %>% as.Date()
wells@data
wells@data$COMPLETION_year <- lubridate::year(wells@data$COMPLETION_POSIX)
wells@data$COMPLETION_year
wells@data %>% group_by(COMLETION_year) %>% tally()
wells@data %>% group_by(COMpLETION_year) %>% tally()
wells@data %>% group_by(COMPLETION_year) %>% tally()
wells@data %>% group_by(COMPLETION_year) %>% tally() %>% arrange(desc(n))
wells@data %>% group_by(COMPLETION_year) %>% tally() %>% arrange(desc(n)) %>% topn(1)
wells@data %>% group_by(COMPLETION_year) %>% tally() %>% arrange(desc(n)) %>% top_n(1)
wells@data %>% group_by(COMPLETION_year) %>% summarise(number_of_wells) %>% arrange(desc(n)) %>% top_n(1)
wells@data %>% group_by(COMPLETION_year) %>% summarise(number_of_wells = n()) %>% arrange(desc(n)) %>% top_n(1)
wells@data %>% group_by(COMPLETION_year) %>% summarise(number_of_wells = n()) %>% arrange(desc(number_of_weels)) %>% top_n(1)
wells@data %>% group_by(COMPLETION_year) %>% summarise(number_of_wells = n()) %>% arrange(desc(number_of_wells)) %>% top_n(1)
wells@data$COMPLETION_year <- lubridate::year(wells@data$COMPLETION_POSIX)
wells@data %>%
group_by(COMPLETION_year) %>%
summarise(number_of_wells = n()) %>%
arrange(desc(number_of_wells)) %>%
top_n(1)
wells@data %>%
group_by(COMPLETION_year) %>%
summarise(number_of_wells = n()) %>%
arrange(desc(number_of_wells)) %>%
top_n(1)
wells@data %>%
group_by(COMPLETION_year) %>%
summarise(number_of_wells = length(unique(KID))) %>%
arrange(desc(number_of_wells)) %>%
top_n(1)
earthquakes@data[which(earthquakes@data$POSIX == max(earthquakes@data$POSIX)), ]
earthquakes@data[which(earthquakes@data$POSIX == max(earthquakes@data$POSIX)), ] %>% data.frame()
earthquakes@data$year <- lubridate::year(earthquakes@data$POSIX)
earthquakes@data %>%
group_by(year) %>%
tally() %>%
filter(year %in% c(2002, 2012, 2015))
earthquakes@data %>%
group_by(year) %>%
tally() %>%
filter(year %in% c(2002, 2012, 2015))
%>% as.data.frame()
earthquakes@data %>%
group_by(year) %>%
tally() %>%
filter(year %in% c(2002, 2012, 2015)) %>% as.data.frame()
earthquakes@data$year <- lubridate::year(earthquakes@data$POSIX)
earthquakes@data %>%
group_by(year) %>%
tally() %>%
filter(year %in% c(2002, 2012, 2015)) %>%
as.data.frame()
wells@data$COMPLETION_POSIX %<>% as.POSIXct()
head(kansas@polygons[[1]]@Polygons[[1]]@coords)
proj4string(earthquakes)
proj4string(wells)
